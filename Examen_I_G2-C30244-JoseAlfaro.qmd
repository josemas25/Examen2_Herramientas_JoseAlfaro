---
title: "Examen FInal"
author: "Jose Manuel Alfaro S C30244"
format: html
editor: visual
---

## Creacion del git ignore

$ touch .gitignore

pego lo siguiente en el .gitignore .Rhistory .RData .Ruserdata

$ git add .
$ git commit - m "feat: Agrega archivo .gitignore y Examen_I_G2-C30244-JoseAlfaro.xlsx"

### Librerias

```{r}
library(tidyverse)
library(readxl)


```

### Carga de datos

```{r}
moras <- read_xlsx("moras.xlsx")

```

## Puntos de Excel en R

2)  

```{r}
moras %>% 
  summarise(minimo_salario=min(SALARIO,na.rm=TRUE),
            minimo_edad=min(EDAD,na.rm=TRUE),
            cuartil1_salario=quantile(SALARIO,0.25,na.rm=TRUE),
            cuartil1_edad=quantile(EDAD,0.25,na.rm=TRUE),
            mediana_salario=median(SALARIO,na.rm = TRUE),
            mediana_edad=median(EDAD,na.rm = TRUE),
            cuartil3_salario=quantile(SALARIO,0.75,na.rm=TRUE),
            cuartil3_edad=quantile(EDAD,0.75,na.rm=TRUE),
            max_salario=max(SALARIO,na.rm = TRUE),
            max_edad=max(EDAD,na.rm = TRUE),
            promedio_salario=mean(SALARIO,na.rm=TRUE),
            promedio_edad=mean(EDAD,na.rm=TRUE))




```

$ git add .
$ git commit -m "feat: agrega el archibo qmd con el punto 2"

3)  

```{r}
moras %>% 
  mutate(ZSCORE_SALARIO=(SALARIO-mean(SALARIO,na.rm=TRUE))/sd(SALARIO,na.rm = TRUE),
         ZSCORE_EDAD=(EDAD-mean(EDAD,na.rm=TRUE))/sd(EDAD,na.rm = TRUE),
         ES_ATIPICO_SALARIO=ifelse(abs(ZSCORE_SALARIO)>1.96,"SI","NO"),
         ES_ATIPICO_EDAD=ifelse(abs(ZSCORE_EDAD)>1.96,"SI","NO"))



```

$ git add Examen_I_G2-C30244-JoseAlfaro.qmd 
$ git commit -m "feat: argrega punto 2"


4)

```{r}

moras %>% 
  summarise(porcentaje_na_sexo=sum(is.na(SEXO))/length(SEXO),
            porcentaje_na_salario=sum(is.na(SALARIO))/length(SALARIO),
            porcentaje_na_aseguramiento=sum(is.na(TIPO_ASEGURAMIENTO))/length(TIPO_ASEGURAMIENTO),
            porcentaje_na_sector=sum(is.na(SECTOR))/length(SECTOR),
            porcentaje_na_activo=sum(is.na(INDICADOR_ACTIVO))/length(INDICADOR_ACTIVO),
            porcentaje_na_extranjero=sum(is.na(INDICADOR.EXTRANJERO))/length(INDICADOR.EXTRANJERO),
            porcentaje_na_moroso=sum(is.na(INDICADOR_MOROSO))/length(INDICADOR_MOROSO),
            porcentaje_na_edad=sum(is.na(EDAD))/length(EDAD))



```

$ git add Examen_I_G2-C30244-JoseAlfaro.qmd
$ git commit -m "feat: agrega punto 4"

5)
hay valores faltantes en

SALARIO
TIPO_ASEGURAMIENTO
EDAD

```{r}
moras <- moras %>% 
  mutate(SALARIO=ifelse(is.na(SALARIO),mean(SALARIO,na.rm=TRUE),SALARIO),
         TIPO_ASEGURAMIENTO=ifelse(is.na(TIPO_ASEGURAMIENTO),"ASALARIADO",TIPO_ASEGURAMIENTO),
         EDAD=ifelse(is.na(EDAD),mean(EDAD,na.rm=TRUE),EDAD))



```

$ git add Examen_I_G2-C30244-JoseAlfaro.qmd
$ git commit -m "feat: agraga punto 5"


6)

```{r}
theme_set(theme_minimal())

moras %>% 
  ggplot(aes(x=SEXO))+
  geom_bar(fill="blue")+
  labs(title = "Cantidad de individuos por sexo",
       x="Sexo",
       y="Cantidad")

moras %>% 
  ggplot(aes(x=SALARIO))+
  geom_histogram(fill="blue")+
  labs(title = "Cantidad de individuos por salario",
       x="Salario",
       y="Cantidad")

moras %>% 
  ggplot(aes(x=TIPO_ASEGURAMIENTO))+
  geom_bar(fill="blue")+
  coord_flip() +
  labs(title = "Cantidad de individuos por seguro",
       x="Seguro",
       y="Cantidad")

moras %>% 
  ggplot(aes(x=SECTOR))+
  geom_bar(fill="blue")+
  labs(title = "Cantidad de individuos por sector",
       x="Sector",
       y="Cantidad")

moras %>% 
  ggplot(aes(x=INDICADOR_ACTIVO))+
  geom_bar(fill="blue")+
  labs(title = "Cantidad de individuos segun es seguro activo",
       x="Activo",
       y="Cantidad")
moras %>% 
  ggplot(aes(x=INDICADOR.EXTRANJERO))+
  geom_bar(fill="blue")+
  labs(title = "Cantidad de individuos segun si es extranjero",
       x="Extranjero",
       y="Cantidad")
moras %>% 
  ggplot(aes(x=INDICADOR_MOROSO))+
  geom_bar(fill="blue")+
  labs(title = "Cantidad de individuos segun si es moroso",
       x="Moroso",
       y="Cantidad")
moras %>% 
  ggplot(aes(x=EDAD))+
  geom_histogram(fill="blue")+
  labs(title = "Cantidad de individuos por edad",
       x="Edad",
       y="Cantidad")

```



